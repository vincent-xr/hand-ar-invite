
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Thiệp AR trên tay</title>
  <style>
    body, html { margin:0; padding:0; overflow:hidden; }
    #video {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    #invite {
      position: absolute;
      display: none;
      pointer-events: none;
      transform: translate(-50%, -50%);
    }
    #invite img {
      max-width: 400px;
      border-radius: 12px;
      background: transparent;
    }
    #nameText {
      position: absolute;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: bold;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      display: inline-block;
      white-space: nowrap;
      z-index: 10;
    }
  </style>
</head>

<body>
  <video id="video" autoplay playsinline></video>
  <div id="invite">
    <img src="invite.png" alt="Thiệp">
  </div>
  <div id="nameText">Thân mời bạn</div>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

  <script>
    const video = document.getElementById('video');
    const invite = document.getElementById('invite');
    const nameText = document.getElementById('nameText');

    const name = decodeURIComponent(new URLSearchParams(window.location.search).get('name') || 'bạn');
    nameText.textContent = `Thân mời ${name}`;

    const hands = new Hands({
      locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
    });
    hands.setOptions({
      maxNumHands: 1,
      modelComplexity: 1,
      minDetectionConfidence: 0.7,
      minTrackingConfidence: 0.5
    });
    hands.onResults(results => {
      if (results.multiHandLandmarks?.length) {
        const lm = results.multiHandLandmarks[0][9];
        invite.style.left = `${lm.x * window.innerWidth}px`;
        invite.style.top = `${lm.y * window.innerHeight}px`;
        invite.style.display = 'block';
      } else {
        invite.style.display = 'none';
      }
    });

    const cam = new Camera(video, {
      onFrame: () => hands.send({image: video}),
      width: 640, height: 480,
      facingMode: 'environment'
    });
    cam.start();
  </script>
</body>
</html>
